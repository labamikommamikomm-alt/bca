<odoo>
    <template id="report_general_ledger">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <div class="text-center">
                        <h3 t-esc="company.name"/>
                        <h4>LAPORAN BUKU BESAR</h4>
                        <p t-if="display_mode == 'detail'">Periode: <span t-esc="column_headers[0]"/></p>
                    </div>

                    <table class="table table-sm table-condensed mt-4" t-if="display_mode == 'summary'">
                        <thead>
                            <tr style="background-color:#f2f2f2;">
                                <th>Kode Akun</th>
                                <th>Nama Akun</th>
                                <th t-foreach="column_headers" t-as="header" class="text-right">
                                    Saldo Akhir (<t t-esc="header"/>)
                                </th>
                            </tr>
                        </thead>
                        <tbody t-foreach="grouped_lines" t-as="type_name">
                            <tr>
                                <td t-att-colspan="2 + len(column_headers)">
                                    <strong><t t-esc="type_name"/></strong>
                                </td>
                            </tr>
                            <tr t-foreach="grouped_lines[type_name]" t-as="line">
                                <td style="padding-left: 20px;"><span t-esc="line['code']"/></td>
                                <td><span t-esc="line['name']"/></td>
                                <td t-foreach="line['ending_balances']" t-as="balance" class="text-right">
                                    <span t-esc="balance" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div t-if="display_mode == 'detail'">
                        <t t-foreach="grouped_lines" t-as="type_name">
                            <h4 class="mt-4" style="background-color: #f2f2f2; padding: 5px;">
                                <t t-esc="type_name"/>
                            </h4>
                            <t t-foreach="grouped_lines[type_name]" t-as="account">
                                <div class="mt-3" style="page-break-inside: avoid;">
                                    <h5><span t-esc="account['code']"/> - <span t-esc="account['name']"/></h5>
                                    <table class="table table-sm table-bordered">
                                        <thead>
                                            <tr>
                                                <th colspan="5" class="text-right">Saldo Awal</th>
                                                <th class="text-right"><span t-esc="account['begin_balance']" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></th>
                                            </tr>
                                            <tr style="background-color:#f2f2f2;">
                                                <th>Tanggal</th>
                                                <th>Jurnal</th>
                                                <th>Partner</th>
                                                <th>Keterangan</th>
                                                <th class="text-right">Debit</th>
                                                <th class="text-right">Kredit</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr t-foreach="account['lines']" t-as="line">
                                                <td><span t-field="line.date"/></td>
                                                <td><span t-field="line.move_id.name"/></td>
                                                <td><span t-field="line.partner_id.name"/></td>
                                                <td><span t-field="line.name"/></td>
                                                <td class="text-right"><span t-field="line.debit" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></td>
                                                <td class="text-right"><span t-field="line.credit" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr class="border-top">
                                                <td colspan="4" class="text-right"><strong>Total Mutasi</strong></td>
                                                <td class="text-right"><strong><span t-esc="account['total_debit']" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></strong></td>
                                                <td class="text-right"><strong><span t-esc="account['total_credit']" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></strong></td>
                                            </tr>
                                            <tr>
                                                <td colspan="5" class="text-right"><strong>Saldo Akhir</strong></td>
                                                <td class="text-right"><strong><span t-esc="account['ending_balances'][0]" t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/></strong></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </t>
                        </t>
                    </div>

                </div>
            </t>
        </t>
    </template>
</odoo>